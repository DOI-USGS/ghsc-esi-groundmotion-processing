<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="gmprocess.waveform_processing.pretesting" href="gmprocess.waveform_processing.pretesting.html" /><link rel="prev" title="gmprocess.waveform_processing.nn_quality_assurance" href="gmprocess.waveform_processing.nn_quality_assurance.html" />

    <meta name="generator" content="sphinx-3.4.0, furo 2020.12.28.beta22"/>
        <title>gmprocess.waveform_processing.phase - gmprocess 1.0.4 documentation</title>
      <link rel="stylesheet" href="../_static/styles/furo.css?digest=d315feae89b83a5365ff3ccc3644a1018972e3a0">
    <link rel="stylesheet" href="../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" href="../_static/styles/furo-extensions.css?digest=26485485040e7aaf717c13fd0188a5ad2c2deb60">
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script defer="defer" src="../_static/jquery.js"></script>
    <script defer="defer" src="../_static/underscore.js"></script>
    <script defer="defer" src="../_static/doctools.js"></script>
    <script defer src="../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<div class="announcement">
  <aside class="announcement-content">
     <a href='https://github.com/usgs/groundmotion-processing' style='text-decoration: none'><h1>Ground-motion Processing Software</h1></a> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">gmprocess 1.0.4 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/gmprocess_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Objective</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html#motivation">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html#target-use-cases">Target Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/workspace.html">Workspace</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/running.html">Running the code</a></li>
</ul>
<p class="caption"><span class="caption-text">Processing Steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../processing-steps/reading.html">Reading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processing-steps/retrieve.html">Retrieving data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processing-steps/windowing.html">Windowing data</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../processing-steps/index.html">Waveform processing</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../processing-steps/waveform-processing.html">Waveform Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing-steps/waveform-processing/initial-qc.html">Initial quality control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing-steps/waveform-processing/remove-response.html">Removing instrument response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing-steps/waveform-processing/phase-pickers.html">Phase pickers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing-steps/waveform-processing/baseline-correction.html">Baseline correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing-steps/waveform-processing/filtering.html">Filtering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../processing-steps/data-units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processing-steps/waveform-metrics.html">Waveform metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processing-steps/station-metrics.html">Station metrics</a></li>
</ul>
<p class="caption"><span class="caption-text">Using gmprocess</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gmprocess/gmprocess.html">The gmprocess command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gmprocess/reading.html">Reading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gmprocess/waveform-processing.html">Waveform processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gmprocess/reports.html">Processing reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gmprocess/exporting.html">Exporting data</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utilities/gmworkspace.html">The gmworkspace command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/gmconvert.html">Converting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/matlab.html">Matlab utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Python Scripting</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scripting/index.html">Data structures</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripting/data-structures.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripting/data-structures/station-trace.html">StationTrace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripting/data-structures/station-stream.html">StationStream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripting/data-structures/stream-collection.html">StreamCollection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/scripting.html">Writing Python scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/waveform-metrics.html">Waveform metrics</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../developer/code-layout.html">Code layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/readers.html">Adding new data readers</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="gmprocess.html">API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="gmprocess.core.html">gmprocess.core</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.core.stationstream.html">gmprocess.core.stationstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.core.stationtrace.html">gmprocess.core.stationtrace</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.core.streamcollection.html">gmprocess.core.streamcollection</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="gmprocess.io.html">gmprocess.io</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.catalog.html">gmprocess.io.catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.fetcher.html">gmprocess.io.fetcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.global_fetcher.html">gmprocess.io.global_fetcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.nga.html">gmprocess.io.nga</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.read.html">gmprocess.io.read</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.read_directory.html">gmprocess.io.read_directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.report.html">gmprocess.io.report</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.seedname.html">gmprocess.io.seedname</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.stream.html">gmprocess.io.stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.io.utils.html">gmprocess.io.utils</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="gmprocess.utils.html">gmprocess.utils</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.args.html">gmprocess.utils.args</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.config.html">gmprocess.utils.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.event.html">gmprocess.utils.event</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.exception.html">gmprocess.utils.exception</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.logging.html">gmprocess.utils.logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.models.html">gmprocess.utils.models</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.plot.html">gmprocess.utils.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.utils.tables.html">gmprocess.utils.tables</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="gmprocess.waveform_processing.html">gmprocess.waveform_processing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.adjust_highpass.html">gmprocess.waveform_processing.adjust_highpass</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.corner_frequencies.html">gmprocess.waveform_processing.corner_frequencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.fft.html">gmprocess.waveform_processing.fft</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.filtering.html">gmprocess.waveform_processing.filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.nn_quality_assurance.html">gmprocess.waveform_processing.nn_quality_assurance</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">gmprocess.waveform_processing.phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.pretesting.html">gmprocess.waveform_processing.pretesting</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.processing.html">gmprocess.waveform_processing.processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.snr.html">gmprocess.waveform_processing.snr</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.spectrum.html">gmprocess.waveform_processing.spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.windows.html">gmprocess.waveform_processing.windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmprocess.waveform_processing.zero_crossings.html">gmprocess.waveform_processing.zero_crossings</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="module-gmprocess.waveform_processing.phase">
<span id="gmprocess-waveform-processing-phase"></span><h1>gmprocess.waveform_processing.phase<a class="headerlink" href="#module-gmprocess.waveform_processing.phase" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.AICPicker">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">AICPicker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">triggers</span></em>, <em class="sig-param"><span class="n">search_window</span></em>, <em class="sig-param"><span class="n">sps</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#AICPicker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.AICPicker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.PowerPicker">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">PowerPicker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tr</span></em>, <em class="sig-param"><span class="n">highpass</span><span class="o">=</span><span class="default_value">1.4</span></em>, <em class="sig-param"><span class="n">lowpass</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">sta</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">sta2</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">lta</span><span class="o">=</span><span class="default_value">20.0</span></em>, <em class="sig-param"><span class="n">hanningWindow</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">threshDetect</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">threshDetect2</span><span class="o">=</span><span class="default_value">2.5</span></em>, <em class="sig-param"><span class="n">threshRestart</span><span class="o">=</span><span class="default_value">99999999</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#PowerPicker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.PowerPicker" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick P-wave arrival time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tr</strong> (<a class="reference internal" href="gmprocess.core.stationtrace.html#gmprocess.core.stationtrace.StationTrace" title="gmprocess.core.stationtrace.StationTrace"><em>StationTrace</em></a>) – StationTrace containing waveform to be picked.</p></li>
<li><p><strong>highpass</strong> (<em>float</em>) – Frequency of the high-pass filter.</p></li>
<li><p><strong>lowpass</strong> (<em>float</em>) – Frequency of the low-pass filter.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Order of the filter.</p></li>
<li><p><strong>sta</strong> (<em>float</em>) – First short term average window (s).</p></li>
<li><p><strong>sta2</strong> (<em>float</em>) – Second short term average window (s).</p></li>
<li><p><strong>lta</strong> (<em>float</em>) – Long term average window (s).</p></li>
<li><p><strong>hanningWindow</strong> (<em>float</em>) – length of the Hanning window in seconds applied to the
characteristic function.</p></li>
<li><p><strong>threshDetect</strong> (<em>float</em>) – First detection threshold.</p></li>
<li><p><strong>threshDetect2</strong> (<em>float</em>) – Second detection threshold.</p></li>
<li><p><strong>threshRestart</strong> (<em>float</em>) – threshRestart is the threshold where the picker rearms to choose
another pick.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>P-wave pick time as number of seconds after start of trace.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.STALTA_Earle">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">STALTA_Earle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">datao</span></em>, <em class="sig-param"><span class="n">sps</span></em>, <em class="sig-param"><span class="n">STAW</span></em>, <em class="sig-param"><span class="n">STAW2</span></em>, <em class="sig-param"><span class="n">LTAW</span></em>, <em class="sig-param"><span class="n">hanning</span></em>, <em class="sig-param"><span class="n">threshold</span></em>, <em class="sig-param"><span class="n">threshold2</span></em>, <em class="sig-param"><span class="n">threshdrop</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#STALTA_Earle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.STALTA_Earle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.butter_bandpass">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">butter_bandpass</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lowcut</span></em>, <em class="sig-param"><span class="n">highcut</span></em>, <em class="sig-param"><span class="n">fs</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#butter_bandpass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.butter_bandpass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.butter_bandpass_filter">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">butter_bandpass_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">lowcut</span></em>, <em class="sig-param"><span class="n">highcut</span></em>, <em class="sig-param"><span class="n">fs</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#butter_bandpass_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.butter_bandpass_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.calc_snr">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">calc_snr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">minloc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#calc_snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.calc_snr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate mean SNR for all Traces in a StationStream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – Stream containing waveforms.</p></li>
<li><p><strong>minloc</strong> (<em>float</em>) – Time in seconds since beginning of Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ratio of signal window (minloc-&gt;end of trace) over
noise window (start of trace-&gt;minloc)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.calc_snr2">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">calc_snr2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">loc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#calc_snr2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.calc_snr2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.create_travel_time_dataframe">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">create_travel_time_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">streams</span></em>, <em class="sig-param"><span class="n">catalog_file</span></em>, <em class="sig-param"><span class="n">ddepth</span></em>, <em class="sig-param"><span class="n">ddist</span></em>, <em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#create_travel_time_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.create_travel_time_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a travel time dataframe, which contains the phase arrrival times
for each station the StreamCollection, for each event in the catalog.
This uses an interpolation method to save time, and the fineness of the
interpolation grid can be adjusted using the ddepth and ddist parameters.
Using the recommended values of ddepth=5 and ddist=0.1 are generally
sufficient to achieve less than 0.1 seconds of error in the travel times,
for most cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>streams</strong> (<a class="reference internal" href="gmprocess.core.streamcollection.html#gmprocess.core.streamcollection.StreamCollection" title="gmprocess.core.streamcollection.StreamCollection"><em>StreamCollection</em></a>) – Streams to calculate travel times for.</p></li>
<li><p><strong>catalog_file</strong> (<em>str</em>) – The path to the CSV file (from ComCat) which contains event info.</p></li>
<li><p><strong>ddepth</strong> (<em>float</em>) – The depth spacing (in km) for the interpolation grid.
Recommended value is 5 km.</p></li>
<li><p><strong>ddist</strong> (<em>float</em>) – The distance spacing (in decimal degrees) for the interpolation
grid. Recommend value is 0.1 degrees.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Retuns:</dt><dd><p>A tuple, containing the travel time dataframe and the catalog
(list of ScalarEvent objects).</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pick_ar">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pick_ar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">picker_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pick_ar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pick_ar" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around the AR P-phase picker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – Stream containing waveforms that need to be picked.</p></li>
<li><p><strong>picker_config</strong> (<em>dict</em>) – Dictionary with parameters for AR P-phase picker. See picker.yml.</p></li>
<li><p><strong>config</strong> (<em>dict</em>) – <dl class="simple">
<dt>Configuration dictionary. Key value here is:</dt><dd><dl class="simple">
<dt>windows:</dt><dd><dl class="simple">
<dt>window_checks:</dt><dd><p>min_noise_duration</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Best estimate for p-wave arrival time (s since start of trace).</p></li>
<li><p>Mean signal to noise ratio based on the pick.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pick_baer">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pick_baer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">picker_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pick_baer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pick_baer" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around the Baer P-phase picker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – Stream containing waveforms that need to be picked.</p></li>
<li><p><strong>picker_config</strong> (<em>dict</em>) – Dictionary with parameters for Baer P-phase picker. See picker.yml.</p></li>
<li><p><strong>config</strong> (<em>dict</em>) – <dl class="simple">
<dt>Configuration dictionary. Key value here is:</dt><dd><dl class="simple">
<dt>windows:</dt><dd><dl class="simple">
<dt>window_checks:</dt><dd><p>min_noise_duration</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Best estimate for p-wave arrival time (s since start of trace).</p></li>
<li><p>Mean signal to noise ratio based on the pick.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pick_kalkan">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pick_kalkan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">picker_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pick_kalkan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pick_kalkan" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around the Kalkan P-phase picker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – Stream containing waveforms that need to be picked.</p></li>
<li><p><strong>picker_config</strong> (<em>dict</em>) – Dictionary with parameters for Kalkan P-phase picker.
See picker.yml.</p></li>
<li><p><strong>config</strong> (<em>dict</em>) – <dl class="simple">
<dt>Configuration dictionary. Key value here is:</dt><dd><dl class="simple">
<dt>windows:</dt><dd><dl class="simple">
<dt>window_checks:</dt><dd><p>min_noise_duration</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Best estimate for p-wave arrival time (s since start of trace).</p></li>
<li><p>Mean signal to noise ratio based on the pick.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pick_power">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pick_power</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">picker_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pick_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pick_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around the PowerPicker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – Stream containing waveforms that need to be picked.</p></li>
<li><p><strong>picker_config</strong> (<em>dict</em>) – Dictionary with parameters for PowerPicker. See picker.yml.</p></li>
<li><p><strong>config</strong> (<em>dict</em>) – <dl class="simple">
<dt>Configuration dictionary. Key value here is:</dt><dd><dl class="simple">
<dt>windows:</dt><dd><dl class="simple">
<dt>window_checks:</dt><dd><p>min_noise_duration</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Best estimate for p-wave arrival time (s since start of trace).</p></li>
<li><p>Mean signal to noise ratio based on the pick.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pick_travel">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pick_travel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">picker_config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pick_travel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pick_travel" title="Permalink to this definition">¶</a></dt>
<dd><p>Use TauP travel time model to find P-Phase arrival time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – StationStream containing 1 or more channels of waveforms.</p></li>
<li><p><strong>origin</strong> (<a class="reference internal" href="gmprocess.utils.event.html#gmprocess.utils.event.ScalarEvent" title="gmprocess.utils.event.ScalarEvent"><em>ScalarEvent</em></a>) – Event origin/magnitude information.</p></li>
<li><p><strong>model</strong> (<em>TauPyModel</em>) – TauPyModel object for computing travel times.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Best estimate for p-wave arrival time (s since start of trace).</p></li>
<li><p>Mean signal to noise ratio based on the pick.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pick_yeck">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pick_yeck</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pick_yeck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pick_yeck" title="Permalink to this definition">¶</a></dt>
<dd><p>IN DEVELOPMENT! SNR based P-phase picker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stream</strong> (<a class="reference internal" href="gmprocess.core.stationstream.html#gmprocess.core.stationstream.StationStream" title="gmprocess.core.stationstream.StationStream"><em>StationStream</em></a>) – Stream containing waveforms that need to be picked.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Best estimate for p-wave arrival time (s since start of trace).</p></li>
<li><p>Mean signal to noise ratio based on the pick.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.pphase_pick">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">pphase_pick</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trace</span></em>, <em class="sig-param"><span class="n">period</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">damping</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">nbins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peak_selection</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#pphase_pick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.pphase_pick" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute P-phase arrival time.</p>
<p>Adapted from Python code written by Francisco Hernandez of the Puerto Rico
Strong Motion Program. That code was in turn adapted from Matlab code written by Dr. Erol
Kalkan, P.E. The algorithms are described here in full:</p>
<p>Kalkan, E. (2016). “An automatic P-phase arrival time picker”, Bull. of
Seismol. Soc. of Am., 106, No. 3, doi: 10.1785/0120150111</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<a class="reference internal" href="gmprocess.core.stationtrace.html#gmprocess.core.stationtrace.StationTrace" title="gmprocess.core.stationtrace.StationTrace"><em>StationTrace</em></a>) – StationTrace containing waveform (acceleration or velocity) data.</p></li>
<li><p><strong>period</strong> (<em>float</em>) – Undamped natural period of the sensor in seconds.
Defaults to 0.01s for sample rates &gt;= 100, 0.1s for sample
rates &lt; 100.</p></li>
<li><p><strong>damping</strong> (<em>float</em>) – Damping ratio.</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – Histogram bin size (default is 2/sampling interval). Regional or
teleseismic records may need different values of bin size for
better picking results)</p></li>
<li><p><strong>selection</strong> (<em>Selector</em>) – One of:
Selector.TO_PEAK - take segment of waveform from beginning to absolute peak value (recommended for fast processing).
Selector.FULL - take full waveform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Float number of seconds from start of trace to P-Phase beginning.</p></li>
<li><p>Signal-to-noise ratio in decibels</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="gmprocess.waveform_processing.phase.sub_calc_snr">
<code class="sig-prename descclassname">gmprocess.waveform_processing.phase.</code><code class="sig-name descname">sub_calc_snr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">pidx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gmprocess/waveform_processing/phase.html#sub_calc_snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gmprocess.waveform_processing.phase.sub_calc_snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gmprocess.waveform_processing.pretesting.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">gmprocess.waveform_processing.pretesting</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="gmprocess.waveform_processing.nn_quality_assurance.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">gmprocess.waveform_processing.nn_quality_assurance</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2020, USGS
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../_sources/apidoc/gmprocess.waveform_processing.phase.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </main>
</div>
  </body>
</html>